(function($){var valid=true,rootUrl=History.getRootUrl();var documentHtml=function(html){var result=String(html).replace(/<\!DOCTYPE[^>]*>/i,'').replace(/<(html|head|body|title|meta|script|link)([\s\>])/gi,'<div class="document-$1"$2').replace(/<\/(html|head|body|title|meta|script)\>/gi,'</div>');return $.trim(result);};definegrid=function(){var browserWidth=$(window).width();if(browserWidth>=1025){pageUnits='px';colUnits='px';pagewidth=960;columns=12;columnwidth=55.25;gutterwidth=27;pagetopmargin=27;rowheight=27;gridonload='off',makehugrid();}if(browserWidth<=1024){pageUnits='%';colUnits='%';pagewidth=92;columns=6;columnwidth=15;gutterwidth=2;pagetopmargin=27;rowheight=27;gridonload='off';makehugrid();}if(browserWidth<=640){pageUnits='%';colUnits='%';pagewidth=92;columns=2;columnwidth=47;gutterwidth=6;pagetopmargin=27;rowheight=27;gridonload='off';makehugrid();}}function startLoading(){console.log('start loading');$('#loading').show();}function progressLoading(){console.log('progress loading');}function doneLoading(data,textStatus,jqXHR,url,title,relativeUrl){console.log('done loading');var $data=$(documentHtml(data)),$dataBody=$data.find('.document-body:first'),$dataContent=$dataBody.find('#content').filter(':first'),$dataContent=$dataContent[0].innerHTML,curpage=window.location.pathname.split('/').pop(),homepage=rootUrl;$('#content').html($dataContent);$('body').scrollTop(0);$('body').removeClass().addClass(title);document.title=$data.find('.document-title:first').text();if(typeof window._gaq!=='undefined'){window._gaq.push(['_trackPageview',relativeUrl]);}}function failLoading(data,textStatus,jqXHR,url){console.log('fail loading');document.location.href=url;return false;}function finishLoading(){console.log('finish loading');$('#loading').hide();}function checkValue(name,value){var message='';switch(name){case'nom':if(value==''){valid=false;message='J\'aimerai vraiment savoir ton nom.';}else{valid=true;}break;case'email':if(value==''){valid=false;message='J\'aimerai vraiment connaitre ton mail.';}else{valid=true;}break;case'message':if(value==''){valid=false;message='Tu veux mÃªme pas me dire bonjour ?';}else{valid=true;}break;}return message;}function headerHeight(){var $headerHeight=$('.header').outerHeight();if($headerHeight%27!=0){$('.header').outerHeight(Math.ceil($headerHeight/27)*27);}}function preinit(){$(window).load(function(){init();finishLoading();});}function init(){definegrid();setgridonload();headerHeight();$('body').on('click tap','[data-ajaxLink]',function(ev){var $this=$(this),url=$this.attr('href'),title=$this.attr('title')||null;if(ev.which==2||ev.metaKey){return true;}History.pushState(null,title,url);ev.preventDefault();return false;});$(window).bind('statechange',function(ev){var State=History.getState(),url=State.url,title=State.title,relativeUrl=url.replace(rootUrl,'');$.ajax({url:url,beforeSend:startLoading(),xhrFields:{onprogress:progressLoading()},}).done(function(data,textStatus,jqXHR){doneLoading(data,textStatus,jqXHR,url,title,relativeUrl);}).fail(function(data,textStatus,jqXHR){failLoading(data,textStatus,jqXHR,url);}).always(finishLoading());});$('input, textarea').on('focusout',function(ev){$(this).attr('placeholder',checkValue($(this)[0].name,$(this)[0].value))});$('#form--submit').on('click',function(ev){ev.preventDefault();$('#contact-form').trigger('submit');return false;});$('#contact-form').on('submit',function(ev){var nom=$('#form--nom').val();var mail=$('#form--email').val();var message=$('#form--message').val();if(valid){if(nom==''||mail==''||message==''){console.log('champ non remplis');}else{$.ajax({type:$(this).attr('method'),url:$(this).attr('action'),data:$(this).serialize(),beforeSend:function(){$('#form--submit').addClass('is-on-progress');},xhrFields:{onprogress:function(ev){var progress=ev.loaded/ev.totalSize*100;}}}).done(function(data){$('#form--submit').removeClass('is-on-progress');$('#form--submit').addClass('is-done');$('#contact-form')[0].reset();$('#form--nom').attr('placeholder','ton nom');$('#form--email').attr('placeholder','ton email');$('#form--message').attr('placeholder','ton message');}).fail(function(data){$('#form--submit').removeClass('is-on-progress');$('#form--submit').addClass('is-fail');});}}return false;});$('input, textarea').on('focusin',function(){if($('#form--submit').hasClass('is-done')){$('#form--submit').removeClass('is-done')}else if($('#form--submit').hasClass('is-fail')){$('#form--submit').removeClass('is-fail');}});}$(document).ready(function(){startLoading();preinit();});$(window).resize(function(){definegrid();setgridonresize();});})(jQuery);